<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emploi du Temps - Audio Cours</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- Loader -->
    <div id="loader" class="loader">
        <div class="spinner"></div>
        <p>Chargement des données...</p>
    </div>

    <!-- Header -->
    <header class="header">
        <h1>Mon Emploi du Temps</h1>
        <p class="subtitle">Enregistrements audio et transcriptions</p>
    </header>

    <!-- Controls -->
    <div class="controls">
        <div class="week-toggle">
            <button id="btn-semaine-a" class="week-btn active">Semaine A</button>
            <button id="btn-semaine-b" class="week-btn">Semaine B</button>
        </div>
        <div class="filters">
            <select id="filter-matiere">
                <option value="">Toutes les matières</option>
            </select>
            <select id="filter-status">
                <option value="">Tous les statuts</option>
                <option value="detected">Détecté</option>
                <option value="transcribing">Transcription...</option>
                <option value="summarizing">Résumé...</option>
                <option value="done">Terminé</option>
                <option value="error">Erreur</option>
            </select>
        </div>
    </div>

    <!-- Timetable Grid -->
    <div class="timetable-container">
        <div class="timetable" id="timetable">
            <!-- Generated by JavaScript -->
        </div>
    </div>

    <!-- Modal for course details -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">&times;</button>
            <div class="modal-header">
                <h2 id="modal-title">Détails du cours</h2>
                <div class="modal-info">
                    <span id="modal-prof"></span>
                    <span id="modal-salle"></span>
                    <span id="modal-time"></span>
                </div>
            </div>
            
            <!-- Audio Player -->
            <div class="audio-section" id="audio-section">
                <h3>Enregistrement audio</h3>
                <div class="audio-player">
                    <audio id="audio-player" controls></audio>
                    <div class="audio-status" id="audio-status"></div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <button class="tab-btn active" data-tab="transcription">Transcription</button>
                <button class="tab-btn" data-tab="resume">Résumé</button>
            </div>

            <!-- Tab Content -->
            <div class="tab-content">
                <div id="tab-transcription" class="tab-pane active">
                    <div class="transcription-text" id="transcription-text">
                        <p class="placeholder">Aucune transcription disponible</p>
                    </div>
                </div>
                <div id="tab-resume" class="tab-pane">
                    <div class="resume-text" id="resume-text">
                        <p class="placeholder">Aucun résumé disponible</p>
                    </div>
                </div>
            </div>

            <!-- Recordings list -->
            <div class="recordings-list" id="recordings-list">
                <h3>Enregistrements associés</h3>
                <div id="recordings-container"></div>
            </div>
        </div>
    </div>

    <!-- Section pour les enregistrements sans cours associé -->
    <section class="orphan-recordings-section" id="orphan-section">
        <div class="orphan-header">
            <h2>Enregistrements sans cours</h2>
            <p class="orphan-subtitle">Enregistrements non associés à un créneau de l'emploi du temps</p>
            <div class="orphan-filters">
                <select id="orphan-filter-status">
                    <option value="">Tous les statuts</option>
                    <option value="detected">Détecté</option>
                    <option value="transcribing">Transcription...</option>
                    <option value="summarizing">Résumé...</option>
                    <option value="done">Terminé</option>
                    <option value="error">Erreur</option>
                </select>
            </div>
        </div>
        <div class="orphan-recordings-grid" id="orphan-recordings-grid">
            <!-- Généré par JavaScript -->
            <p class="placeholder">Aucun enregistrement orphelin</p>
        </div>
    </section>

    <!-- Modal pour enregistrement orphelin -->
    <div id="orphan-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" id="orphan-modal-close">&times;</button>
            <div class="modal-header">
                <h2 id="orphan-modal-title">Enregistrement</h2>
                <div class="modal-info">
                    <span id="orphan-modal-date"></span>
                    <span id="orphan-modal-status"></span>
                </div>
            </div>
            
            <!-- Audio Player -->
            <div class="audio-section">
                <h3>Enregistrement audio</h3>
                <div class="audio-player">
                    <audio id="orphan-audio-player" controls></audio>
                    <div class="audio-status" id="orphan-audio-status"></div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <button class="tab-btn active" data-tab="orphan-transcription">Transcription</button>
                <button class="tab-btn" data-tab="orphan-resume">Résumé</button>
            </div>

            <!-- Tab Content -->
            <div class="tab-content">
                <div id="tab-orphan-transcription" class="tab-pane active">
                    <div class="transcription-text" id="orphan-transcription-text">
                        <p class="placeholder">Aucune transcription disponible</p>
                    </div>
                </div>
                <div id="tab-orphan-resume" class="tab-pane">
                    <div class="resume-text" id="orphan-resume-text">
                        <p class="placeholder">Aucun résumé disponible</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Status Legend -->
    <div class="legend">
        <h4>Légende des statuts</h4>
        <div class="legend-items">
            <div class="legend-item">
                <span class="legend-color status-detected"></span>
                <span>Détecté</span>
            </div>
            <div class="legend-item">
                <span class="legend-color status-transcribing"></span>
                <span>Transcription</span>
            </div>
            <div class="legend-item">
                <span class="legend-color status-summarizing"></span>
                <span>Résumé</span>
            </div>
            <div class="legend-item">
                <span class="legend-color status-done"></span>
                <span>Terminé</span>
            </div>
            <div class="legend-item">
                <span class="legend-color status-error"></span>
                <span>Erreur</span>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="timetable-data.js"></script>
    <script src="app.js"></script>
</body>
</html>
